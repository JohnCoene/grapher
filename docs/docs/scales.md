---
id: scales
title: Scales
sidebar_label: Scales
---

grapher has a small but sufficient system of scales similar to that of [ggplot2](https://ggplot2.tidyverse.org/). In grapher scales apply to:

- nodes color
- nodes size
- links source and target color

Then again we will use the data generated by the `make_data` function.

```r
g <- make_data() # mock data

head(g)
#> $nodes
#> # A tibble: 100 x 4
#>    id    label  size color  
#>    <chr> <chr> <dbl> <chr>  
#>  1 1     U47      15 #ffaa0e
#>  2 2     Y77      39 #2ca030
#>  3 3     C3       35 #ba43b4
#>  4 4     K37      17 #78a641
#>  5 5     N14      33 #78a641
#>  6 6     A27      12 #8a60b0
#>  7 7     K37      15 #6f63bb
#>  8 8     R44      45 #6f63bb
#>  9 9     O41      24 #ffaa0e
#> 10 10    L64      39 #78a641
#> # … with 90 more rows
#> 
#> $links
#> # A tibble: 100 x 3
#>    source target hidden
#>    <chr>  <chr>  <lgl> 
#>  1 1      41     FALSE 
#>  2 2      63     FALSE 
#>  3 3      55     FALSE 
#>  4 4      15     FALSE 
#>  5 5      8      FALSE 
#>  6 6      95     FALSE 
#>  7 7      33     FALSE 
#>  8 8      33     FALSE 
#>  9 9      27     FALSE 
#> 10 10     18     FALSE 
#> # … with 90 more rows
```

## Node size

If we want to scale the node size given the data we generated we could do (I say "could" because in this case there is another way we shall cover later). We use `scale_node_size` which takes two arguments, 1) `variable` the bare variable to scale, 2) `range` the size range into which `variable` should be scaled.

```r
graph(g) %>% 
  scale_node_size(size, range = c(20, 150))
```

## Node color

We can also scale the color of the nodes to given `variable`, we've actually already used this in the [guide on clustering](cluster.md). We'll repeat that example below.

Note the `palette` argument which takes any vector of color of your choosing, though it must be said that it is strict with hexadecimals; use the full hex e.g.: use `#ffffff` for white rather than the shorter `#fff` or it will error.

```r
graph(g) %>% 
  graph_cluster() %>% 
  scale_node_color(cluster, palette = c("red", "white", "blue"))
```

But you can of course scale on any `variable` included in the nodes meta data.

```r
graph(g) %>% 
  scale_node_color(size)
```

You can also color nodes according to their `x`, `y`, and `z` coordinates with `scale_node_color_coords`. This function rescales the coordinates and uses then as red, green, blue. However, because it relies on coordinates these must have been computed already. It will not work with a live layout.

```r
graph(g) %>% 
  graph_static_layout() %>% 
  scale_node_color_coords()
```

## Links color

In grapher, the color of a link is actually split in two:

1. The color from the source node to the middle.
2. The color from the middle to the target node.

This is something that is again genius in ngraph (the underlying JavaScript library). It's incredibly simple yet extremely powerful. Thanks to this split, one can easily define links color according to meta data in the nodes (source and target). 

There are four scaling functions that will let you adjust those colors.

- `scale_link_source_color`
- `scale_link_target_color`
- `scale_link_color`
- `scale_link_color_coords`

In the list above, the first two are straight forward, they allow you to scale the links color according to meta data belonging to the links. The other two are slightly more interesting, `scale_link_color` will let you color the links according to meta data held in the nodes at either end of each respective link.

We could, for instance, color the links according to the cluster to which belong nodes at either end. This results, in a much more better looking graph.

```r
graph(g) %>% 
  graph_cluster() %>% 
  scale_link_color(cluster, palette = graph_palette_light())
```

Finally you can color links according to the position of nodes at either end. Just as for `scale_node_color_coords`, the coordinates of the nodes must have been computed in order to for this method to apply.

```r
graph(g) %>% 
  graph_offline_layout() %>% 
  scale_link_color_coords()
```
